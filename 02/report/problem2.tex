\begin{problem}
	\label{problem_2}
	Μια αλυσίδα fast food πρόκειται να ανοίξει μια σειρά από εστιατόρια κατά μήκος της Εγνατίας. Οι n πιθανές τοποθεσίες έχουν αποστάσεις από την αρχή της Εγνατίας σε αύξουσα σειρά $m_1,m_2,\ldots,m_n$ σε μέτρα. Το προσδοκώμενο κέρδος από το άνοιγμα ενός εστιατορίου στην τοποθεσία $i$ είναι $p_i$, $i=1,2,\ldots n$. Σε κάθε τοποθεσία η αλυσίδα μπορεί να ανοίξει μόνο ένα εστιατόριο. Επιπλέον, δύο εστιατόρια πρέπει να απέχουν μεταξύ τους τουλάχιστον $k$ μέτρα.
\end{problem}

\subsection{Μέγιστο προσδοκώμενο κέρδος}

	\subsubsection{Βέλτιστη υποδομή}

		Συμβολίζουμε το μέγιστο προδοκώμενο κέρδος, έχοντας στη διάθεσή μας τις τοποθεσίες $m_1,\ldots,m_i$, με $R_i$. Χρειάζεται να σπάσουμε το πρόβλημα στα εξής δύο· στο μέγιστο προσδοκώμενο κέρδος για το σύνολο των τοποθεσιών πριν την $m_i$ και το προσδοκώμενο κέρδος της τοποθεσίας $m_i$. Αρχικά, υποθέτουμε πως $m_i-m_{j}\geqslant k$. Τότε, $R_i=R_j+p_i$ όπου $R_j$ είναι το μέγιστο κέρδος έχοντας στη διάθεσή μας τις τοποθεσίες $m_1,\ldots,m_{i-1}$ και $p_i$ το προσδοκώμενο κέρδος ενός εστιατορίου στην τοποθεσία $m_i$. Θα αποδείξουμε πως η $R_j$ είναι μέρος της $R_i$.\par
		\vspace*{6pt}
		\textsl{Έστω πως $R_j$ δεν είναι το μέγιστο προσδοκώμενο κέρδος έχοντας στη διάθεσή μας τις τοποθεσίες $m_1,\ldots,m_{i-1}$. Τότε, υπάρχει μία τιμή $R_f>R_j$. Αυτό συνεπάγεται πως υπάρχει μία νέα λύση $R_i^{\prime}$ η οποία είναι μεγαλύτερη της μέγιστης. Άτοπον. }$\blacksquare$\par
		\vspace*{6pt}
		Τώρα θα εξετάσουμε τη γενική περίπτωση όπου η συνθήκη $m_i-m_{j}\geqslant k$ δεν ικανοποιείται απαραίτητα. Στην περίπτωση αυτή η προηγούμενη λύση $\(R_j+p_i\)$ παίρνει τη μορφή $R_j+p_i\cdot\delta[m_i,m_{j}]$, όπου $\delta:[m_1,\ldots,m_n]\times[m_1,\ldots,m_n]\to\left\{0,1\right\}$ με τύπο
		\begin{equation*}
			\delta[m_x,m_y]=\begin{cases}
				0,&\text{if}\;m_x-m_y<k\\
				1,&\text{if}\;m_x-m_y\geqslant k\\
			\end{cases}.
		\end{equation*}
		Στην περίπτωση όπου $\delta[m_i,m_{i-1}]=0$, τότε δύναται να είναι $p_i>R_j$. Επομένως, η βέλτιστη υποδομή είναι $R_i=\max{\left\{p_i,R_j+p_i\cdot\delta(m_i,m_{j})\right\}}$.

	\subsubsection{Αναδρομική λύση}

		Εκφράζουμε την βέλτιστη λύση ενός προβλήματος μεγέθους $i$ συναρτήσει των βέλτιστων λύσεων υποπροβλημάτων μεγέθους $j<i$. Στην προκειμένη αναζητούμε το μέγιστο προσδοκώμενο κέρδος, $R_i$, όταν είναι διαθέσιμες οι τοποθεσίες $m_j,\ldots,m_i,\;1\leqslant j\leqslant i\leqslant n$. Θέτωντας $R_1=p_1$ για $j=i=1$, για $m_j,\ldots,m_i,\;1\leqslant j<i\leqslant n$ είναι
		\begin{equation}
			\label{eq:recursive_sol}
			\mathclap{R_i=\max{\left\{p_i,\max_{j<i}{\left\{R_j+\delta[m_i,m_j]\cdot p_i\right\}}\right\}}}
		\end{equation}

	\subsubsection{Υπολογισμός βέλτιστης λύσης}

		Βάσει της σχέσης \eqref{eq:recursive_sol} προκύπτει ο Αλγόριθμος \ref{alg:2_2}. Η βέλτιστη λύση κάθε υποπροβλήματος αποθηκεύεται σε έναν πίνακα $R$. Επομένως, λύνοντας τα προβλήματα κατά αύξουσα σειρά ως προς το μέγεθός τους, κάθε αναδρομή δεν χρειάζεται να υπολογίσει εκ νέου την βέλτιση λύση για κάθε υποπρόβλημα αλλά να την αναζητήσει στον πίνακα $R$.\par

        \input{pseudocode/a2p2.tex}

\subsection{Ορθότητα αλγορίθμου}

		\noindent\textbf{Loop invariant }\textsl{ Μετά από κάθε $i$-στή επανάληψη του βρόχου των γραμμών $6-11$, η θέση $i$ του πίνακα $R$ περιέχει το μέγιστο προσδοκώμενο κέρδος έχοντας εστιατόρια από το σημείο $m_1$ έως και $m_i$ τηρώντας τον περιορισμό σχετικά με τις αποστάσεις δύο οποιονδήποτε εστιατορίων.}\par

		\subsubsection{Αρχικοποίηση}

			Πριν την είσοδο του program counter στον επαναληπτικό βρόχο των γραμμών $6-11$, στην θέση $1$ του πίνακα $R$ είναι αποθηκευμένο το προσδοκώμενο κέρδος του εστιατορίου της τοποθεσίας $m_1$, $R[1]=p[1]$, το οποίο είναι όντως το μέγιστο προσδοκώμενο συνολικό κέρδος στην περίπτωση που έχουμε στη διάθεσή μας μία μόνο τοποθεσία. Το loop invariant ικανοποιείται πριν την πρώτη εκτέλεση του έξω επαναληπτικού βρόχου.

		\subsubsection{Διατήρηση}

			Έστω πως το loop invariant ικανοποιείται μετά την $i$-στή εκτέλεση του επαναληπτικού βρόχου των γραμμών $6-11$, δηλαδή $R[i]$ είναι η τιμή του μεγίστου προσδοκώμενου κέρδους έχοντας διαθέσιμες τις τοποθεσίες $m_1$ έως και $m_i$. Για την επόμενη εκτέλεση του εξωτερικού βρόχου $(i+1)$ πριν την πρώτη εκτέλεση του εσωτερικού επαναληπτικού βρόχου είναι $R[i+1]=p[i+1]$ και για κάθε εκτέλεση του έσω βρόχου $\(\forall j\in[1,i]\)$ υπάρχουν δύο περιπτώσεις.
			\begin{enumerate}[label=\roman*.$\;$]
				\item Οι τοποθεσίες $m[i+1]$ και $m[j]$ ικανοποιούν τη συνθήκη $m[i+1]-m[j]\geqslant k$. Τότε, στο μέγιστο προσδοκώμενο κέρδος με διαθέσιμες τοποθεσίες τις $m_1,\ldots,m_{j},\;j\leqslant i<i+1$ προστίθεται το κέρδος του εστιατορίου της τοποθεσίας $m[i+1]$ και το άθροισμα αυτό καταχωρείται στην θέση $R[i+1]$.
				\item Οι τοποθεσίες $m[i+1]$ και $m[j]$  δεν ικανοποιούν τη συνθήκη $m[i+1]-m[j]\geqslant k$. Τότε, μεταξύ του μεγίστου προσδοκώμενου κέρδους έχοντας διαθέσιμες τις τοποθεσίες $m_1,\ldots,m_{i+1}$, $R[i+1]$ ---η οποία πριν την πρώτη εκτέλεση της γραμμής $8$ για δεδομένο $i$ περιέχει την τιμή $p[i+1]$--- και του μεγίστου προσδοκώμενου κέρδους έχοντας διαθέσιμες τις τοποθεσίες $m_1,\ldots,m_{j}$, $R[j]$, για $j\leqslant i<i+1$ επιλέγεται το μέγιστο και καταχωρείται στη θέση $R[i+1]$.
			\end{enumerate}

			Άρα, με το πέρας της $(i+1)$-στής εκτέλεσης του εξωτερικού επαναληπτικού βρόχου η θέση $R[i+1]$ περιέχει το μέγιστο προσδοκώμενο κέρδος έχοντας διαθέσιμες τις τοποθεσίες $m_1,\ldots,m_{i+1}$. Το loop invariant διατηρείται.\par

		\subsubsection{Τερματισμός}

			Η συνθήκη η οποία επιφέρει τον τερματισμό του εξωτερικού επαναληπτικού βρόχου (γραμμές $6-11$) είναι $i=n+1>n$ αφού, μετά το πέρας κάθε εκτέλεσης του βρόχου, ο μετρητής $i$ προσαυξάνεται κατά $1$. Για $i=n+1$, το σώμα του βρόχου δεν εκτελείται. Αυτό σημαίνει πως στη θέση $R[n]$ είναι καταχωρημένο το μέγιστο προσδοκώμενο κέρδος έχοντας διαθέσιμες τις τοποθεσίες $m_1,\ldots,m_n$.

		\vspace*{-18pt}
		\subsection*{}

			Βάσει των παραπάνω, προκύπτει η ορθότητα του αλγορίθμου. Αξίζει να σημειωθεί πως ο δυναμικός προγραμματισμός εφαρμόστηκε στο συγκεκριμένο πρόβλημα βελτιστοποίησης διότι υπήρχε καλώς ορισμένη βέλτιστη υποδομή και επειδή υπάρχει επικάλυψη των υποπροβλημάτων, δηλαδή σε κάθε αναδρομή συναντώνται συγκεκριμένα υποπροβλήματα αντί κάθε φορά να δημιουργούνται νέα όπως στην τεχνική \textsl{διαίρει \& βασίλευε}.\cit{handbook}

\subsection{Χρόνος εκτέλεσης αλγορίθμου}

Στην γραμμή $2$ του Αλγορίθμου \ref{alg:2_2} υπολογίζεται το μέγεθος του πίνακα $p$ σε σταθερό χρόνο και το αποτέλεσμα καταχωρείται σε μία νέα μεταβλητή $n$ σε σταθερό χρόνο $\bigO(1)$.\par
Στην γραμμή $3$ του Αλγορίθμου \ref{alg:2_2} δημιουργείται ένας νέος κενός πίνακας μεγέθους $n$ σε σταθερό χρόνο $\bigO(1)$.\par
Το σώμα του επαναληπτικού βρόχου των γραμμών $4-5$ εκτελείται $n$ φορές. Σε κάθε εκτέλεση της γραμμής $5$ πραγματοποιείται καταχώρηση μίας τιμής σε κάποια θέση του πίνακα $R$ το οποίο απαιτεί σταθερό χρόνο $\bigO(1)$. Επομένως, συνολικά η $\tw{for}$ των γραμμών $4-5$ χρειάζεται $\bigO(n)$ χρόνο.\par
Το σώμα του $\tw{for}$ της γραμμής $6$ εκτελείται $n-1$ φορές. Το σώμα του $\tw{for}$ της γραμμής $7$ εκτελείται
\begin{equation*}
    \sum_{i=2}^{n}{\(\sum_{j=1}^{i}{i}\)}=\sum_{i=2}^{n}{i}=\frac{1}{2}n^2+\frac{1}{2}n-1\;\text{φορές.}
\end{equation*}
Ο έλεγχος της συνθήκης της γραμμής $8$ γίνεται σε σταθερό χρόνο $\bigO(1)$. Η γραμμή $9$ πρώτα υπολογίζει το άθροισμα $R[j]+p[i]$ σε σταθερό χρόνο. Έπειτα, υπολογίζει το μέγιστο μεταξύ των $p[i]$ και $R[j]+p[i]$ σε σταθερό χρόνο και τέλος καταχωρεί το αποτέλεσμα στον πίνακα $R$ σε επίσης σταθερό χρόνο. Συνεπώς, η γραμμή $9$ εκτελεί σειριακά εργασίες σταθερού χρόνου. Αυτό σημαίνει πως ο χρόνος εκτέλεσής της είναι $\bigO(1)$.\par
Η γραμμή $11$ εκτελεί τις παρόμοιες ενέργειες με την γραμμή $9$ πάνω σε διαφορετικές τιμές. Επομένως, η ανάλυση της προηγούμενης παραγράφου για τη γραμμή $9$ εφαρμόζεται και για την γραμμή $11$ και προκύπτει πως ο χρόνος εκτέλεσής της είναι $\bigO(1)$.\par
Βάσει των παραπάνω ο συνολικός χρόνος εκτέλεσης του Αλγορίθμου \ref{alg:2_2} είναι $T(n)=\bigO(1)+n\cdot\bigO(1)+\(\frac{1}{2}n^2+\frac{1}{2}n-1\)\cdot\bigO(1)$. Δηλαδή,
\begin{equation}
	T(n)=\bigO(n^2).
\end{equation}